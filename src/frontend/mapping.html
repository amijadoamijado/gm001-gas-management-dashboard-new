<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>GM001 - ãƒ‡ãƒ¼ã‚¿ãƒãƒƒãƒ”ãƒ³ã‚°ç®¡ç†</title>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }
    
    body {
      font-family: 'Inter', sans-serif;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      min-height: 100vh;
      padding: 20px;
    }
    
    .container {
      max-width: 1600px;
      margin: 0 auto;
      background: rgba(255, 255, 255, 0.95);
      border-radius: 20px;
      box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
      padding: 30px;
    }
    
    .header {
      text-align: center;
      margin-bottom: 40px;
      padding-bottom: 20px;
      border-bottom: 2px solid #f0f0f0;
    }
    
    .header h1 {
      color: #2c3e50;
      font-size: 2.5rem;
      font-weight: 700;
      margin-bottom: 10px;
    }
    
    .project-code {
      display: inline-block;
      background: linear-gradient(135deg, #3498db, #2980b9);
      color: white;
      padding: 8px 16px;
      border-radius: 20px;
      font-size: 0.9rem;
      font-weight: 600;
      margin-bottom: 20px;
    }
    
    .mapping-grid {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 30px;
      margin-bottom: 30px;
    }
    
    .mapping-panel {
      background: white;
      border-radius: 15px;
      padding: 25px;
      box-shadow: 0 5px 15px rgba(0, 0, 0, 0.08);
    }
    
    .panel-header {
      display: flex;
      align-items: center;
      margin-bottom: 20px;
    }
    
    .panel-icon {
      width: 40px;
      height: 40px;
      border-radius: 10px;
      display: flex;
      align-items: center;
      justify-content: center;
      margin-right: 15px;
      font-size: 1.2rem;
    }
    
    .panel-title {
      font-size: 1.2rem;
      font-weight: 600;
      color: #2c3e50;
    }
    
    .source-list {
      max-height: 400px;
      overflow-y: auto;
      border: 1px solid #e0e0e0;
      border-radius: 8px;
      padding: 15px;
    }
    
    .source-item {
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 12px;
      border: 1px solid #f0f0f0;
      border-radius: 6px;
      margin-bottom: 8px;
      cursor: grab;
      transition: all 0.3s ease;
    }
    
    .source-item:hover {
      background: #f8f9fa;
      border-color: #3498db;
      transform: translateY(-2px);
    }
    
    .source-item.dragging {
      opacity: 0.5;
      transform: rotate(5deg);
    }
    
    .source-info {
      display: flex;
      flex-direction: column;
      flex: 1;
    }
    
    .source-name {
      font-weight: 600;
      color: #2c3e50;
      margin-bottom: 4px;
    }
    
    .source-type {
      font-size: 0.8rem;
      color: #7f8c8d;
    }
    
    .mapping-target {
      min-height: 300px;
      border: 2px dashed #bdc3c7;
      border-radius: 8px;
      padding: 20px;
      text-align: center;
      transition: all 0.3s ease;
    }
    
    .mapping-target.drag-over {
      border-color: #3498db;
      background: rgba(52, 152, 219, 0.1);
      border-style: solid;
    }
    
    .mapping-target.has-mappings {
      border-color: #27ae60;
      background: rgba(39, 174, 96, 0.05);
    }
    
    .mapped-field {
      display: flex;
      align-items: center;
      justify-content: space-between;
      background: white;
      border: 1px solid #27ae60;
      border-radius: 6px;
      padding: 12px;
      margin-bottom: 8px;
      box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
    }
    
    .mapped-field-info {
      display: flex;
      flex-direction: column;
      flex: 1;
    }
    
    .mapped-field-name {
      font-weight: 600;
      color: #27ae60;
      margin-bottom: 4px;
    }
    
    .mapped-field-source {
      font-size: 0.8rem;
      color: #7f8c8d;
    }
    
    .remove-mapping {
      background: #e74c3c;
      color: white;
      border: none;
      border-radius: 4px;
      padding: 6px 10px;
      cursor: pointer;
      font-size: 0.8rem;
      transition: background 0.3s ease;
    }
    
    .remove-mapping:hover {
      background: #c0392b;
    }
    
    .controls {
      display: flex;
      gap: 15px;
      margin-bottom: 30px;
      padding: 20px;
      background: #f8f9fa;
      border-radius: 12px;
    }
    
    .btn {
      background: linear-gradient(135deg, #3498db, #2980b9);
      color: white;
      border: none;
      padding: 12px 24px;
      border-radius: 8px;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s ease;
      display: flex;
      align-items: center;
      gap: 8px;
    }
    
    .btn:hover {
      background: linear-gradient(135deg, #2980b9, #1f639a);
      transform: translateY(-2px);
    }
    
    .btn-success {
      background: linear-gradient(135deg, #27ae60, #2ecc71);
    }
    
    .btn-success:hover {
      background: linear-gradient(135deg, #229954, #27ae60);
    }
    
    .btn-warning {
      background: linear-gradient(135deg, #f39c12, #e67e22);
    }
    
    .btn-warning:hover {
      background: linear-gradient(135deg, #e67e22, #d35400);
    }
    
    .preview-section {
      background: white;
      border-radius: 15px;
      padding: 25px;
      box-shadow: 0 5px 15px rgba(0, 0, 0, 0.08);
      margin-top: 30px;
    }
    
    .preview-table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 15px;
    }
    
    .preview-table th,
    .preview-table td {
      padding: 12px;
      text-align: left;
      border-bottom: 1px solid #e0e0e0;
    }
    
    .preview-table th {
      background: #f8f9fa;
      font-weight: 600;
      color: #2c3e50;
    }
    
    .status-indicator {
      position: fixed;
      top: 20px;
      right: 20px;
      padding: 10px 20px;
      border-radius: 20px;
      color: white;
      font-weight: 600;
      font-size: 0.9rem;
      z-index: 1000;
      display: none;
    }
    
    .status-success {
      background: #27ae60;
    }
    
    .status-error {
      background: #e74c3c;
    }
    
    .status-loading {
      background: #f39c12;
    }
    
    @media (max-width: 1200px) {
      .mapping-grid {
        grid-template-columns: 1fr;
        gap: 20px;
      }
    }
    
    @media (max-width: 768px) {
      .container {
        padding: 20px;
        margin: 10px;
      }
      
      .header h1 {
        font-size: 2rem;
      }
      
      .controls {
        flex-direction: column;
      }
      
      .btn {
        justify-content: center;
      }
    }
  </style>
</head>
<body>
  <div class="container">
    <div class="header">
      <div class="project-code">GM001</div>
      <h1>ãƒ‡ãƒ¼ã‚¿ãƒãƒƒãƒ”ãƒ³ã‚°ç®¡ç†</h1>
      <div class="subtitle">ãƒ‡ãƒ¼ã‚¿ã‚½ãƒ¼ã‚¹ã¨ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ã®ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ãƒãƒƒãƒ”ãƒ³ã‚°</div>
    </div>
    
    <div class="controls">
      <button class="btn" onclick="loadSources()">
        ğŸ”„ ã‚½ãƒ¼ã‚¹æ›´æ–°
      </button>
      <button class="btn btn-success" onclick="saveMapping()">
        ğŸ’¾ ãƒãƒƒãƒ”ãƒ³ã‚°ä¿å­˜
      </button>
      <button class="btn btn-warning" onclick="resetMapping()">
        ğŸ”„ ãƒªã‚»ãƒƒãƒˆ
      </button>
      <button class="btn" onclick="previewData()">
        ğŸ‘ï¸ ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼
      </button>
    </div>
    
    <div class="mapping-grid">
      <!-- ãƒ‡ãƒ¼ã‚¿ã‚½ãƒ¼ã‚¹ãƒ‘ãƒãƒ« -->
      <div class="mapping-panel">
        <div class="panel-header">
          <div class="panel-icon" style="background: linear-gradient(135deg, #3498db, #2980b9);">
            ğŸ“Š
          </div>
          <div class="panel-title">ãƒ‡ãƒ¼ã‚¿ã‚½ãƒ¼ã‚¹ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰</div>
        </div>
        <div class="source-list" id="sourceFields">
          <div class="loading-message">ãƒ‡ãƒ¼ã‚¿ã‚½ãƒ¼ã‚¹æƒ…å ±ã‚’èª­ã¿è¾¼ã¿ä¸­...</div>
        </div>
      </div>
      
      <!-- ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ãƒ‘ãƒãƒ« -->
      <div class="mapping-panel">
        <div class="panel-header">
          <div class="panel-icon" style="background: linear-gradient(135deg, #27ae60, #2ecc71);">
            ğŸ¯
          </div>
          <div class="panel-title">ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰</div>
        </div>
        <div class="mapping-target" id="mappingTarget">
          <div class="empty-state">
            <p>ãƒ‡ãƒ¼ã‚¿ã‚½ãƒ¼ã‚¹ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã‚’ã“ã“ã«ãƒ‰ãƒ©ãƒƒã‚°ã‚¢ãƒ³ãƒ‰ãƒ‰ãƒ­ãƒƒãƒ—</p>
            <p style="color: #7f8c8d; font-size: 0.9rem; margin-top: 10px;">ãƒãƒƒãƒ”ãƒ³ã‚°ã‚’é–‹å§‹ã—ã¦ãã ã•ã„</p>
          </div>
        </div>
      </div>
    </div>
    
    <!-- ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ã‚»ã‚¯ã‚·ãƒ§ãƒ³ -->
    <div class="preview-section" id="previewSection" style="display: none;">
      <div class="panel-header">
        <div class="panel-icon" style="background: linear-gradient(135deg, #9b59b6, #8e44ad);">
          ğŸ‘ï¸
        </div>
        <div class="panel-title">ãƒ‡ãƒ¼ã‚¿ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼</div>
      </div>
      <div id="previewContent">
        <!-- ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ãƒ‡ãƒ¼ã‚¿ãŒã“ã“ã«è¡¨ç¤ºã•ã‚Œã‚‹ -->
      </div>
    </div>
  </div>
  
  <div id="statusIndicator" class="status-indicator"></div>
  
  <script>
    // GM001 ãƒ‡ãƒ¼ã‚¿ãƒãƒƒãƒ”ãƒ³ã‚°ç®¡ç† JavaScript
    let currentMapping = {};
    let sourceFields = [];
    let dashboardFields = [
      { name: 'totalRevenue', label: 'ç·å£²ä¸Š', type: 'currency' },
      { name: 'monthlyRevenue', label: 'æœˆåˆ¥å£²ä¸Š', type: 'currency' },
      { name: 'totalProfit', label: 'ç·åˆ©ç›Š', type: 'currency' },
      { name: 'profitMargin', label: 'åˆ©ç›Šç‡', type: 'percentage' },
      { name: 'customerCount', label: 'é¡§å®¢æ•°', type: 'number' },
      { name: 'newCustomers', label: 'æ–°è¦é¡§å®¢', type: 'number' },
      { name: 'growthRate', label: 'æˆé•·ç‡', type: 'percentage' },
      { name: 'monthlyGrowth', label: 'æœˆæˆé•·ç‡', type: 'percentage' }
    ];
    
    // åˆæœŸåŒ–
    document.addEventListener('DOMContentLoaded', function() {
      initializeMapping();
      loadSources();
      loadExistingMapping();
    });
    
    // ãƒãƒƒãƒ”ãƒ³ã‚°åˆæœŸåŒ–
    function initializeMapping() {
      setupDragAndDrop();
      renderDashboardFields();
    }
    
    // ãƒ‰ãƒ©ãƒƒã‚°ã‚¢ãƒ³ãƒ‰ãƒ‰ãƒ­ãƒƒãƒ—è¨­å®š
    function setupDragAndDrop() {
      const mappingTarget = document.getElementById('mappingTarget');
      
      mappingTarget.addEventListener('dragover', function(e) {
        e.preventDefault();
        this.classList.add('drag-over');
      });
      
      mappingTarget.addEventListener('dragleave', function(e) {
        e.preventDefault();
        this.classList.remove('drag-over');
      });
      
      mappingTarget.addEventListener('drop', function(e) {
        e.preventDefault();
        this.classList.remove('drag-over');
        
        const fieldData = JSON.parse(e.dataTransfer.getData('text/plain'));
        const targetField = e.target.closest('.dashboard-field');
        
        if (targetField) {
          const targetId = targetField.dataset.fieldId;
          addMapping(fieldData, targetId);
        }
      });
    }
    
    // ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°
    function renderDashboardFields() {
      const mappingTarget = document.getElementById('mappingTarget');
      mappingTarget.innerHTML = '';
      
      dashboardFields.forEach(field => {
        const fieldElement = createDashboardFieldElement(field);
        mappingTarget.appendChild(fieldElement);
      });
      
      updateMappingTargetState();
    }
    
    // ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰è¦ç´ ä½œæˆ
    function createDashboardFieldElement(field) {
      const div = document.createElement('div');
      div.className = 'dashboard-field';
      div.dataset.fieldId = field.name;
      
      const mapping = currentMapping[field.name];
      
      if (mapping) {
        div.className += ' mapped-field';
        div.innerHTML = `
          <div class="mapped-field-info">
            <div class="mapped-field-name">${field.label}</div>
            <div class="mapped-field-source">ã‚½ãƒ¼ã‚¹: ${mapping.sourceName}</div>
          </div>
          <button class="remove-mapping" onclick="removeMapping('${field.name}')">å‰Šé™¤</button>
        `;
      } else {
        div.className += ' empty-field';
        div.innerHTML = `
          <div class="field-placeholder">
            <strong>${field.label}</strong>
            <br>
            <small>${field.type}</small>
          </div>
        `;
      }
      
      return div;
    }
    
    // ãƒ‡ãƒ¼ã‚¿ã‚½ãƒ¼ã‚¹ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰èª­ã¿è¾¼ã¿
    function loadSources() {
      showStatus('loading', 'ãƒ‡ãƒ¼ã‚¿ã‚½ãƒ¼ã‚¹æƒ…å ±ã‚’èª­ã¿è¾¼ã¿ä¸­...');
      
      google.script.run
        .withSuccessHandler(onSourcesLoaded)
        .withFailureHandler(onSourcesError)
        .getDataSourceFields({ projectCode: 'GM001' });
    }
    
    // ãƒ‡ãƒ¼ã‚¿ã‚½ãƒ¼ã‚¹ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰èª­ã¿è¾¼ã¿æˆåŠŸ
    function onSourcesLoaded(fields) {
      sourceFields = fields;
      renderSourceFields();
      hideStatus();
    }
    
    // ãƒ‡ãƒ¼ã‚¿ã‚½ãƒ¼ã‚¹ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰èª­ã¿è¾¼ã¿ã‚¨ãƒ©ãƒ¼
    function onSourcesError(error) {
      console.error('ãƒ‡ãƒ¼ã‚¿ã‚½ãƒ¼ã‚¹æƒ…å ±èª­ã¿è¾¼ã¿ã‚¨ãƒ©ãƒ¼:', error);
      showStatus('error', 'ãƒ‡ãƒ¼ã‚¿ã‚½ãƒ¼ã‚¹æƒ…å ±ã®èª­ã¿è¾¼ã¿ã«å¤±æ•—ã—ã¾ã—ãŸ');
      
      // ãƒ‡ãƒ¢ãƒ‡ãƒ¼ã‚¿ã‚’è¡¨ç¤º
      showDemoSourceFields();
    }
    
    // ãƒ‡ãƒ¼ã‚¿ã‚½ãƒ¼ã‚¹ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°
    function renderSourceFields() {
      const sourceList = document.getElementById('sourceFields');
      sourceList.innerHTML = '';
      
      sourceFields.forEach(field => {
        const fieldElement = createSourceFieldElement(field);
        sourceList.appendChild(fieldElement);
      });
    }
    
    // ãƒ‡ãƒ¼ã‚¿ã‚½ãƒ¼ã‚¹ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰è¦ç´ ä½œæˆ
    function createSourceFieldElement(field) {
      const div = document.createElement('div');
      div.className = 'source-item';
      div.draggable = true;
      
      div.innerHTML = `
        <div class="source-info">
          <div class="source-name">${field.name}</div>
          <div class="source-type">${field.type} - ${field.description || 'èª¬æ˜ãªã—'}</div>
        </div>
      `;
      
      div.addEventListener('dragstart', function(e) {
        e.dataTransfer.setData('text/plain', JSON.stringify(field));
        this.classList.add('dragging');
      });
      
      div.addEventListener('dragend', function(e) {
        this.classList.remove('dragging');
      });
      
      return div;
    }
    
    // ãƒãƒƒãƒ”ãƒ³ã‚°è¿½åŠ 
    function addMapping(sourceField, targetFieldId) {
      currentMapping[targetFieldId] = {
        sourceId: sourceField.id,
        sourceName: sourceField.name,
        sourceType: sourceField.type
      };
      
      renderDashboardFields();
      showStatus('success', `${sourceField.name} ã‚’ãƒãƒƒãƒ”ãƒ³ã‚°ã—ã¾ã—ãŸ`);
    }
    
    // ãƒãƒƒãƒ”ãƒ³ã‚°å‰Šé™¤
    function removeMapping(targetFieldId) {
      delete currentMapping[targetFieldId];
      renderDashboardFields();
      showStatus('success', 'ãƒãƒƒãƒ”ãƒ³ã‚°ã‚’å‰Šé™¤ã—ã¾ã—ãŸ');
    }
    
    // ãƒãƒƒãƒ”ãƒ³ã‚°ä¿å­˜
    function saveMapping() {
      if (Object.keys(currentMapping).length === 0) {
        showStatus('error', 'ä¿å­˜ã™ã‚‹ãƒãƒƒãƒ”ãƒ³ã‚°ãŒã‚ã‚Šã¾ã›ã‚“');
        return;
      }
      
      showStatus('loading', 'ãƒãƒƒãƒ”ãƒ³ã‚°ã‚’ä¿å­˜ä¸­...');
      
      google.script.run
        .withSuccessHandler(onMappingSaved)
        .withFailureHandler(onMappingSaveError)
        .saveFieldMapping({
          projectCode: 'GM001',
          mapping: currentMapping
        });
    }
    
    // ãƒãƒƒãƒ”ãƒ³ã‚°ä¿å­˜æˆåŠŸ
    function onMappingSaved(result) {
      showStatus('success', 'ãƒãƒƒãƒ”ãƒ³ã‚°ã‚’ä¿å­˜ã—ã¾ã—ãŸ');
    }
    
    // ãƒãƒƒãƒ”ãƒ³ã‚°ä¿å­˜ã‚¨ãƒ©ãƒ¼
    function onMappingSaveError(error) {
      console.error('ãƒãƒƒãƒ”ãƒ³ã‚°ä¿å­˜ã‚¨ãƒ©ãƒ¼:', error);
      showStatus('error', 'ãƒãƒƒãƒ”ãƒ³ã‚°ã®ä¿å­˜ã«å¤±æ•—ã—ã¾ã—ãŸ');
    }
    
    // ãƒãƒƒãƒ”ãƒ³ã‚°ãƒªã‚»ãƒƒãƒˆ
    function resetMapping() {
      if (confirm('ã™ã¹ã¦ã®ãƒãƒƒãƒ”ãƒ³ã‚°ã‚’ãƒªã‚»ãƒƒãƒˆã—ã¾ã™ã‹ï¼Ÿ')) {
        currentMapping = {};
        renderDashboardFields();
        showStatus('success', 'ãƒãƒƒãƒ”ãƒ³ã‚°ã‚’ãƒªã‚»ãƒƒãƒˆã—ã¾ã—ãŸ');
      }
    }
    
    // ãƒ‡ãƒ¼ã‚¿ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼
    function previewData() {
      if (Object.keys(currentMapping).length === 0) {
        showStatus('error', 'ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ã™ã‚‹ãƒãƒƒãƒ”ãƒ³ã‚°ãŒã‚ã‚Šã¾ã›ã‚“');
        return;
      }
      
      showStatus('loading', 'ãƒ‡ãƒ¼ã‚¿ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ã‚’ä½œæˆä¸­...');
      
      google.script.run
        .withSuccessHandler(onPreviewLoaded)
        .withFailureHandler(onPreviewError)
        .getPreviewData({
          projectCode: 'GM001',
          mapping: currentMapping
        });
    }
    
    // ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼èª­ã¿è¾¼ã¿æˆåŠŸ
    function onPreviewLoaded(data) {
      renderPreview(data);
      document.getElementById('previewSection').style.display = 'block';
      showStatus('success', 'ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ã‚’ä½œæˆã—ã¾ã—ãŸ');
    }
    
    // ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ã‚¨ãƒ©ãƒ¼
    function onPreviewError(error) {
      console.error('ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ã‚¨ãƒ©ãƒ¼:', error);
      showStatus('error', 'ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ã®ä½œæˆã«å¤±æ•—ã—ã¾ã—ãŸ');
    }
    
    // ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹è¡¨ç¤º
    function showStatus(type, message) {
      const indicator = document.getElementById('statusIndicator');
      indicator.textContent = message;
      indicator.className = 'status-indicator status-' + type;
      indicator.style.display = 'block';
    }
    
    function hideStatus() {
      setTimeout(() => {
        document.getElementById('statusIndicator').style.display = 'none';
      }, 3000);
    }
    
    // ãƒãƒƒãƒ”ãƒ³ã‚°ã‚¿ãƒ¼ã‚²ãƒƒãƒˆçŠ¶æ…‹æ›´æ–°
    function updateMappingTargetState() {
      const mappingTarget = document.getElementById('mappingTarget');
      const hasMappings = Object.keys(currentMapping).length > 0;
      
      if (hasMappings) {
        mappingTarget.classList.add('has-mappings');
      } else {
        mappingTarget.classList.remove('has-mappings');
      }
    }
    
    // ãƒ‡ãƒ¢ãƒ‡ãƒ¼ã‚¿è¡¨ç¤º
    function showDemoSourceFields() {
      const demoFields = [
        { id: 'revenue', name: 'å£²ä¸Šé‡‘é¡', type: 'NUMBER', description: 'æœˆåˆ¥å£²ä¸Šåˆè¨ˆ' },
        { id: 'profit', name: 'åˆ©ç›Šé‡‘é¡', type: 'NUMBER', description: 'æœˆåˆ¥åˆ©ç›Šåˆè¨ˆ' },
        { id: 'customers', name: 'é¡§å®¢æ•°', type: 'NUMBER', description: 'ã‚¢ã‚¯ãƒ†ã‚£ãƒ–é¡§å®¢æ•°' },
        { id: 'orders', name: 'æ³¨æ–‡æ•°', type: 'NUMBER', description: 'æœˆåˆ¥æ³¨æ–‡ä»¶æ•°' },
        { id: 'date', name: 'æ—¥ä»˜', type: 'DATE', description: 'ãƒ‡ãƒ¼ã‚¿æ—¥ä»˜' }
      ];
      
      sourceFields = demoFields;
      renderSourceFields();
      hideStatus();
    }
    
    // æ—¢å­˜ãƒãƒƒãƒ”ãƒ³ã‚°èª­ã¿è¾¼ã¿
    function loadExistingMapping() {
      google.script.run
        .withSuccessHandler(onExistingMappingLoaded)
        .withFailureHandler(() => {
          // ã‚¨ãƒ©ãƒ¼æ™‚ã¯ç„¡è¦–ï¼ˆæ–°è¦ãƒãƒƒãƒ”ãƒ³ã‚°ï¼‰
        })
        .getExistingMapping({ projectCode: 'GM001' });
    }
    
    // æ—¢å­˜ãƒãƒƒãƒ”ãƒ³ã‚°èª­ã¿è¾¼ã¿æˆåŠŸ
    function onExistingMappingLoaded(mapping) {
      if (mapping && typeof mapping === 'object') {
        currentMapping = mapping;
        renderDashboardFields();
      }
    }
  </script>
</body>
</html>